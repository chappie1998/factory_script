var x=Object.defineProperty,H=Object.defineProperties,Q=Object.getOwnPropertyDescriptor,Z=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var R=(t,e,r)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,p=(t,e)=>{for(var r in e||(e={}))C.call(e,r)&&R(t,r,e[r]);if(j)for(var r of j(e))et.call(e,r)&&R(t,r,e[r]);return t},c=(t,e)=>H(t,Z(e));var rt=(t,e)=>{for(var r in e)x(t,r,{get:e[r],enumerable:!0})},nt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of tt(e))!C.call(t,i)&&i!==r&&x(t,i,{get:()=>e[i],enumerable:!(n=Q(e,i))||n.enumerable});return t};var it=t=>nt(x({},"__esModule",{value:!0}),t);var ht={};rt(ht,{default:()=>F});module.exports=it(ht);var Y=require("fs"),g=require("path"),T=require("typechain");var $="__factory";var at=require("typechain");function v(t){return t.type.originalType!=="tuple"?t.type.originalType:`(${t.type.components.map(e=>v(e)).join(",")})`}function N(t){return`${t.name}(${t.inputs.map(e=>v(e)).join(",")})`}function P(t,e){return t.length===0?"":`${t.map((r,n)=>`${r.name||`arg${n}`}: ${l(r.type,e)}`).join(", ")}, `}function w(t,e={}){if(t.length===0)return e.returnResultObject?e.returnResultObject:"void";let r=t.map(n=>f(n.type,e));return r.length>1?`[${r.join(",")}]`:r[0]}function l(t,e={}){switch(t.type){case"u8":case"u16":case"u32":case"u64":return"BigNumberish";case"b256":case"address":return"string";case"byte":return"BytesLike";case"array":return`[${Array(t.size).fill(l(t.itemType,{useStructs:!0})).join(", ")}]`;case"bool":return"boolean";case"string":return"string";case"tuple":return I(t,r=>l(r,c(p({},e),{useStructs:!0})));case"enum":return t.structName&&e.useStructs?`${t.structName}Input`:_(t,r=>l(r,c(p({},e),{useStructs:!0})));case"struct":return t.structName&&e.useStructs?`${t.structName}Input`:E(t,r=>l(r,c(p({},e),{useStructs:!0})));case"unknown":return"any";default:return"any"}}function f(t,e={}){if(e.returnResultObject)return e.returnResultObject;switch(t.type){case"u8":case"u16":return"number";case"u32":case"u64":return"bigint";case"b256":case"address":return"string";case"byte":return"BytesLike";case"array":return`[${Array(t.size).fill(f(t.itemType,{useStructs:!0})).join(", ")}]`;case"bool":return"boolean";case"string":return"string";case"tuple":return I(t,r=>f(r,c(p({},e),{useStructs:!0})));case"enum":return t.structName&&e.useStructs?`${t.structName}Output`:_(t,r=>f(r,c(p({},e),{useStructs:!0})));case"struct":return t.structName&&e.useStructs?`${t.structName}Output`:E(t,r=>f(r,c(p({},e),{useStructs:!0})));case"unknown":return"any";case"void":return"void";default:return"any"}}function I(t,e){return`[${t.components.map(r=>e(r.type)).join(", ")}]`}function E(t,e){return`{${t.components.map(r=>`${r.name}: ${e(r.type)}`).join(", ")}}`}function _(t,e){return`Partial<{${t.components.map(r=>`${r.name}: ${e(r.type)}`).join(", ")}}>`}function y(t,e){return e.length===1?k(t,e[0]):ot(t,e)}function ot(t,e){return e.map(r=>k(t,r,`"${N(r)}"`)).join(`
`)}function k(t,e,r){let n,i;return t.isPrepareCall?(n="options?: ContractCallOptions",i="ContractCall"):(n="overrides?: Overrides & { from?: string | Promise<string> }",i=`Promise<${w(e.outputs,{returnResultObject:t.returnResultObject,useStructs:!0})}>`),`
  ${st(e.documentation)}
  ${r!=null?r:e.name}(${P(e.inputs,{useStructs:!0})}${n}): ${i};
`}function st(t){if(!t)return"";let e="/**";t.details&&(e+=`
 * ${t.details}`),t.notice&&(e+=`
 * ${t.notice}`);let r=Object.entries(t.params||{});return r.length&&r.forEach(([n,i])=>{e+=`
 * @param ${n} ${i}`}),t.return&&(e+=`
 * @returns ${t.return}`),e+=`
 */`,e}function U(t){return`'${t.name}': FunctionFragment;`}function B(t){let e=[`functionFragment: '${t.name}'`];return t.inputs.length?e.push(`values: [${t.inputs.map(r=>l(r.type,{useStructs:!0})).join(", ")}]`):e.push("values?: undefined"),`encodeFunctionData(${e.join(", ")}): Uint8Array;`}function G(t){return`decodeFunctionData(functionFragment: '${t.name}', data: BytesLike): DecodedValue;`}var z=new Set(["signer","provider","deployTransaction","deployed","fallback","connect"]);function O(t){return t.structName?`
      export type ${t.structName}Input = ${l(t,{useStructs:!1})}

      export type ${t.structName}Output = ${f(t,{useStructs:!1})}
      `:""}function L(t,e){return`
  import type {
    Interface,
    FunctionFragment,
    DecodedValue,
    Contract,
    ContractCall,
    ContractCallOptions,
    Overrides,
    BigNumberish,
    BytesLike,
    CallResult,
    ScriptTransactionRequest,
    TransactionResult,
  } from 'fuels';
  
  ${Object.values(t.structs).map(n=>O(n[0])).join(`
`)}
  
  ${Object.values(t.enums).map(n=>O(n[0])).join(`
`)}

  interface ${t.name}Interface extends Interface {
    functions: {
      ${Object.values(t.functions).map(n=>n[0]).map(U).join(`
`)}
    };

    ${Object.values(t.functions).map(n=>n[0]).map(B).join(`
`)}

    ${Object.values(t.functions).map(n=>n[0]).map(G).join(`
`)}
  }

  export class ${t.name} extends Contract {
    interface: ${t.name}Interface;
    prepareCall: {
      ${Object.values(t.functions).map(y.bind(null,{isPrepareCall:!0,codegenConfig:e})).join(`
`)}
    };
    submit: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    submitResult: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:"TransactionResult<any>",codegenConfig:e})).join(`
`)}
    };
    dryRun: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    dryRunResult: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:"CallResult",codegenConfig:e})).join(`
`)}
    };
    simulate: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    simulateResult: {
      ${Object.values(t.functions).map(y.bind(null,{returnResultObject:"CallResult",codegenConfig:e})).join(`
`)}
    };

    ${Object.values(t.functions).filter(n=>!z.has(n[0].name)).map(y.bind(null,{codegenConfig:e})).join(`
`)}
  }`}function M(t,e){let{body:r,header:n}=ut(t,e);return`
  ${n}

  export class ${t.name}${$} {
    ${r}
  }
  `}function ut(t,e){let r=`
  import type { Provider, Wallet } from "fuels";
  import { Interface, Contract } from "fuels";
  import type { ${t.name}, ${t.name}Interface } from "../${t.name}";
  const _abi = ${JSON.stringify(e,null,2)};
  `.trim(),n=`
    static readonly abi = _abi;
    static createInterface(): ${t.name}Interface {
      return new Interface(_abi) as ${t.name}Interface;
    }
    static connect(id: string, walletOrProvider: Wallet | Provider): ${t.name} {
      return new Contract(id, _abi, walletOrProvider) as ${t.name};
    }
  `.trim();return{header:r,body:n}}var pt=/str\[(?<length>[0-9]+)\]/,ct=/\[(?<item>[\w\s]+);\s*(?<length>[0-9]+)\]/,mt=/^struct (?<name>\w+)$/,lt=/^enum (?<name>\w+)$/,yt=/^\((?<items>.*)\)$/;function d(t){let r=[n=>n.replace(/\s+/g,"-"),n=>n.replace(/\./g,"-"),n=>n.replace(/_/g,"-"),n=>n.replace(/-[a-z]/g,i=>i.substr(-1).toUpperCase()),n=>n.replace(/-/g,""),n=>n.replace(/^\d+/,""),n=>n.charAt(0).toUpperCase()+n.slice(1)].reduce((n,i)=>i(n),t);if(r==="")throw new Error(`Can't guess class name, please rename file: ${t}`);return r}function S(t,e,r){var h,D,a;let n=t.match(pt);if(n!==null){let o=n[1];return{type:"string",size:parseInt(o,10),originalType:t}}let i=t.match(ct);if(i!==null){let o=i[1],q=i[2];return{type:"array",itemType:S(o,e),size:parseInt(q,10),originalType:t}}let s=(h=mt.exec(t))==null?void 0:h.groups;if(s){if(!e)throw new Error(`${t} specified without components!`);return{type:"struct",components:e,originalType:t,structName:s.name}}let u=(D=lt.exec(t))==null?void 0:D.groups;if(u){if(!e)throw new Error(`${t} specified without components!`);return{type:"enum",components:e,originalType:t,structName:u.name}}if((a=yt.exec(t))==null?void 0:a.groups){if(!e)throw new Error(`${t} specified without components!`);return{type:"tuple",components:e,originalType:t,structName:d(r||"")}}switch(t){case"u8":return{type:"u8",bits:8,originalType:t};case"u16":return{type:"u16",bits:16,originalType:t};case"u32":return{type:"u32",bits:32,originalType:t};case"u64":return{type:"u64",bits:64,originalType:t};case"bool":return{type:"bool",originalType:t};case"address":return{type:"address",originalType:t};case"b256":return{type:"b256",originalType:t};case"byte":return{type:"byte",size:1,originalType:t};default:}return{type:"unknown",originalType:t}}function gt(t,e,r){return{name:t.name,inputs:ft(e,t.inputs),outputs:dt(e,t.outputs),documentation:bt(t,r)}}function V(t,e){return{name:t.name,type:W(t,e)}}function W(t,e){let r=t.components&&t.components.map(i=>({name:i.name,type:W(i,e)})),n=S(t.type,r,t.name);switch(n.type){case"struct":e(n);break;case"tuple":e(n);break;case"enum":e(n);break;default:break}return n}function ft(t,e){return(e||[]).filter(r=>r.type!=="()").map(r=>V(r,t))}function dt(t,e){return!e||e.length===0?[{name:"",type:{type:"void"}}]:e.filter(r=>r.type!=="()").map(r=>V(r,t))}function J(t,e,r){let n=[],i={struct:[],enum:[],tuple:[]};function s(a){["struct","enum","tuple"].includes(a.type)&&i[a.type].findIndex(o=>o.structName===a.structName)===-1&&i[a.type].push(a)}t.forEach(a=>{a.type==="function"&&n.push(gt(a,s,r))});let u=n.reduce((a,o)=>(Array.isArray(a[o.name])?a[o.name].push(o):a[o.name]=[o],a),{}),A=i.struct.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{}),h=i.tuple.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{}),D=i.enum.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{});return{name:d(e),rawName:e,functions:u,structs:A,tuples:h,enums:D}}function bt(t,e){let r=`${t.name}(${(t.inputs||[]).map(({type:n})=>n).join(",")})`;return e&&e.methods&&e.methods[r]}var b=class extends Error{};function K(t){let e;try{e=JSON.parse(t)}catch{throw new b("Not a json")}if(!e)throw new b("Not a json");if(Array.isArray(e))return e;if(Array.isArray(e.abi))return e.abi;if(e.compilerOutput&&Array.isArray(e.compilerOutput.abi))return e.compilerOutput.abi;throw new b("Not a valid ABI")}function X(t){let e;try{e=JSON.parse(t)}catch{return}if(!e||!e.devdoc&&!e.userdoc)return;let r=e.devdoc||{};if(e.userdoc){if(r.notice=e.userdoc.notice,!e.userdoc.methods)return r;r.methods=r.methods||{},Object.entries(e.userdoc.methods).forEach(([n,{notice:i}])=>{r.methods&&(r.methods[n]=c(p({},r.methods[n]),{notice:i}))})}return r}var Tt="./types/fuels-contracts/",F=class extends T.TypeChainTarget{constructor(r){super(r);this.name="Fuels";this.contractCache={};let{cwd:n,outDir:i,allFiles:s}=r;this.outDirAbs=(0,g.resolve)(n,i||Tt),this.allContracts=s.map(u=>d((0,T.getFilename)(u)))}transformFile(r){let n=(0,T.getFilename)(r.path),i=K(r.contents);if(i.length===0)return;let s=X(r.contents),u=J(i,n,s);return this.contractCache[n]={abi:i,contract:u},[this.genContractTypingsFile(u,this.cfg.flags)]}genContractTypingsFile(r,n){return{path:(0,g.join)(this.outDirAbs,`${r.name}.d.ts`),contents:L(r,n)}}afterRun(){return[...Object.keys(this.contractCache).map(i=>{let{contract:s,abi:u}=this.contractCache[i];return{path:(0,g.join)(this.outDirAbs,"factories",`${s.name}${$}.ts`),contents:M(s,u)}}),{path:(0,g.join)(this.outDirAbs,"common.d.ts"),contents:(0,Y.readFileSync)((0,g.join)(__dirname,"../static/common.d.ts"),"utf-8")},{path:(0,g.join)(this.outDirAbs,"index.ts"),contents:this.genReExports()}].filter(Boolean)}genReExports(){let r=[],n=new Set(this.allContracts);for(let i of n){let s=i;r.push(`export type { ${s} } from './${s}'`)}r.push(`
`);for(let i of n){let s=`${i}__factory`;r.push(`export { ${s} } from './factories/${s}'`)}return r.join(`
`)}};0&&(module.exports={});
//# sourceMappingURL=index.js.map