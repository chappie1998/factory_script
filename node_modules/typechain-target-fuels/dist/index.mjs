var Y=Object.defineProperty,q=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var j=(t,e,r)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,c=(t,e)=>{for(var r in e||(e={}))Q.call(e,r)&&j(t,r,e[r]);if(A)for(var r of A(e))Z.call(e,r)&&j(t,r,e[r]);return t},m=(t,e)=>q(t,H(e));import{fileURLToPath as tt}from"url";import et from"path";var rt=()=>tt(import.meta.url),nt=()=>et.dirname(rt()),p=nt();import{readFileSync as dt}from"fs";import{join as T,resolve as bt}from"path";import{getFilename as K,TypeChainTarget as Tt}from"typechain";var D="__factory";import{createPositionalIdentifier as Rt}from"typechain";function R(t){return t.type.originalType!=="tuple"?t.type.originalType:`(${t.type.components.map(e=>R(e)).join(",")})`}function C(t){return`${t.name}(${t.inputs.map(e=>R(e)).join(",")})`}function v(t,e){return t.length===0?"":`${t.map((r,n)=>`${r.name||`arg${n}`}: ${y(r.type,e)}`).join(", ")}, `}function N(t,e={}){if(t.length===0)return e.returnResultObject?e.returnResultObject:"void";let r=t.map(n=>g(n.type,e));return r.length>1?`[${r.join(",")}]`:r[0]}function y(t,e={}){switch(t.type){case"u8":case"u16":case"u32":case"u64":return"BigNumberish";case"b256":case"address":return"string";case"byte":return"BytesLike";case"array":return`[${Array(t.size).fill(y(t.itemType,{useStructs:!0})).join(", ")}]`;case"bool":return"boolean";case"string":return"string";case"tuple":return P(t,r=>y(r,m(c({},e),{useStructs:!0})));case"enum":return t.structName&&e.useStructs?`${t.structName}Input`:I(t,r=>y(r,m(c({},e),{useStructs:!0})));case"struct":return t.structName&&e.useStructs?`${t.structName}Input`:w(t,r=>y(r,m(c({},e),{useStructs:!0})));case"unknown":return"any";default:return"any"}}function g(t,e={}){if(e.returnResultObject)return e.returnResultObject;switch(t.type){case"u8":case"u16":return"number";case"u32":case"u64":return"bigint";case"b256":case"address":return"string";case"byte":return"BytesLike";case"array":return`[${Array(t.size).fill(g(t.itemType,{useStructs:!0})).join(", ")}]`;case"bool":return"boolean";case"string":return"string";case"tuple":return P(t,r=>g(r,m(c({},e),{useStructs:!0})));case"enum":return t.structName&&e.useStructs?`${t.structName}Output`:I(t,r=>g(r,m(c({},e),{useStructs:!0})));case"struct":return t.structName&&e.useStructs?`${t.structName}Output`:w(t,r=>g(r,m(c({},e),{useStructs:!0})));case"unknown":return"any";case"void":return"void";default:return"any"}}function P(t,e){return`[${t.components.map(r=>e(r.type)).join(", ")}]`}function w(t,e){return`{${t.components.map(r=>`${r.name}: ${e(r.type)}`).join(", ")}}`}function I(t,e){return`Partial<{${t.components.map(r=>`${r.name}: ${e(r.type)}`).join(", ")}}>`}function f(t,e){return e.length===1?E(t,e[0]):it(t,e)}function it(t,e){return e.map(r=>E(t,r,`"${C(r)}"`)).join(`
`)}function E(t,e,r){let n,i;return t.isPrepareCall?(n="options?: ContractCallOptions",i="ContractCall"):(n="overrides?: Overrides & { from?: string | Promise<string> }",i=`Promise<${N(e.outputs,{returnResultObject:t.returnResultObject,useStructs:!0})}>`),`
  ${at(e.documentation)}
  ${r!=null?r:e.name}(${v(e.inputs,{useStructs:!0})}${n}): ${i};
`}function at(t){if(!t)return"";let e="/**";t.details&&(e+=`
 * ${t.details}`),t.notice&&(e+=`
 * ${t.notice}`);let r=Object.entries(t.params||{});return r.length&&r.forEach(([n,i])=>{e+=`
 * @param ${n} ${i}`}),t.return&&(e+=`
 * @returns ${t.return}`),e+=`
 */`,e}function _(t){return`'${t.name}': FunctionFragment;`}function U(t){let e=[`functionFragment: '${t.name}'`];return t.inputs.length?e.push(`values: [${t.inputs.map(r=>y(r.type,{useStructs:!0})).join(", ")}]`):e.push("values?: undefined"),`encodeFunctionData(${e.join(", ")}): Uint8Array;`}function k(t){return`decodeFunctionData(functionFragment: '${t.name}', data: BytesLike): DecodedValue;`}var B=new Set(["signer","provider","deployTransaction","deployed","fallback","connect"]);function $(t){return t.structName?`
      export type ${t.structName}Input = ${y(t,{useStructs:!1})}

      export type ${t.structName}Output = ${g(t,{useStructs:!1})}
      `:""}function G(t,e){return`
  import type {
    Interface,
    FunctionFragment,
    DecodedValue,
    Contract,
    ContractCall,
    ContractCallOptions,
    Overrides,
    BigNumberish,
    BytesLike,
    CallResult,
    ScriptTransactionRequest,
    TransactionResult,
  } from 'fuels';
  
  ${Object.values(t.structs).map(n=>$(n[0])).join(`
`)}
  
  ${Object.values(t.enums).map(n=>$(n[0])).join(`
`)}

  interface ${t.name}Interface extends Interface {
    functions: {
      ${Object.values(t.functions).map(n=>n[0]).map(_).join(`
`)}
    };

    ${Object.values(t.functions).map(n=>n[0]).map(U).join(`
`)}

    ${Object.values(t.functions).map(n=>n[0]).map(k).join(`
`)}
  }

  export class ${t.name} extends Contract {
    interface: ${t.name}Interface;
    prepareCall: {
      ${Object.values(t.functions).map(f.bind(null,{isPrepareCall:!0,codegenConfig:e})).join(`
`)}
    };
    submit: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    submitResult: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:"TransactionResult<any>",codegenConfig:e})).join(`
`)}
    };
    dryRun: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    dryRunResult: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:"CallResult",codegenConfig:e})).join(`
`)}
    };
    simulate: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:void 0,codegenConfig:e})).join(`
`)}
    };
    simulateResult: {
      ${Object.values(t.functions).map(f.bind(null,{returnResultObject:"CallResult",codegenConfig:e})).join(`
`)}
    };

    ${Object.values(t.functions).filter(n=>!B.has(n[0].name)).map(f.bind(null,{codegenConfig:e})).join(`
`)}
  }`}function z(t,e){let{body:r,header:n}=ot(t,e);return`
  ${n}

  export class ${t.name}${D} {
    ${r}
  }
  `}function ot(t,e){let r=`
  import type { Provider, Wallet } from "fuels";
  import { Interface, Contract } from "fuels";
  import type { ${t.name}, ${t.name}Interface } from "../${t.name}";
  const _abi = ${JSON.stringify(e,null,2)};
  `.trim(),n=`
    static readonly abi = _abi;
    static createInterface(): ${t.name}Interface {
      return new Interface(_abi) as ${t.name}Interface;
    }
    static connect(id: string, walletOrProvider: Wallet | Provider): ${t.name} {
      return new Contract(id, _abi, walletOrProvider) as ${t.name};
    }
  `.trim();return{header:r,body:n}}var st=/str\[(?<length>[0-9]+)\]/,ut=/\[(?<item>[\w\s]+);\s*(?<length>[0-9]+)\]/,pt=/^struct (?<name>\w+)$/,ct=/^enum (?<name>\w+)$/,mt=/^\((?<items>.*)\)$/;function d(t){let r=[n=>n.replace(/\s+/g,"-"),n=>n.replace(/\./g,"-"),n=>n.replace(/_/g,"-"),n=>n.replace(/-[a-z]/g,i=>i.substr(-1).toUpperCase()),n=>n.replace(/-/g,""),n=>n.replace(/^\d+/,""),n=>n.charAt(0).toUpperCase()+n.slice(1)].reduce((n,i)=>i(n),t);if(r==="")throw new Error(`Can't guess class name, please rename file: ${t}`);return r}function O(t,e,r){var h,x,a;let n=t.match(st);if(n!==null){let o=n[1];return{type:"string",size:parseInt(o,10),originalType:t}}let i=t.match(ut);if(i!==null){let o=i[1],X=i[2];return{type:"array",itemType:O(o,e),size:parseInt(X,10),originalType:t}}let s=(h=pt.exec(t))==null?void 0:h.groups;if(s){if(!e)throw new Error(`${t} specified without components!`);return{type:"struct",components:e,originalType:t,structName:s.name}}let u=(x=ct.exec(t))==null?void 0:x.groups;if(u){if(!e)throw new Error(`${t} specified without components!`);return{type:"enum",components:e,originalType:t,structName:u.name}}if((a=mt.exec(t))==null?void 0:a.groups){if(!e)throw new Error(`${t} specified without components!`);return{type:"tuple",components:e,originalType:t,structName:d(r||"")}}switch(t){case"u8":return{type:"u8",bits:8,originalType:t};case"u16":return{type:"u16",bits:16,originalType:t};case"u32":return{type:"u32",bits:32,originalType:t};case"u64":return{type:"u64",bits:64,originalType:t};case"bool":return{type:"bool",originalType:t};case"address":return{type:"address",originalType:t};case"b256":return{type:"b256",originalType:t};case"byte":return{type:"byte",size:1,originalType:t};default:}return{type:"unknown",originalType:t}}function lt(t,e,r){return{name:t.name,inputs:yt(e,t.inputs),outputs:ft(e,t.outputs),documentation:gt(t,r)}}function L(t,e){return{name:t.name,type:M(t,e)}}function M(t,e){let r=t.components&&t.components.map(i=>({name:i.name,type:M(i,e)})),n=O(t.type,r,t.name);switch(n.type){case"struct":e(n);break;case"tuple":e(n);break;case"enum":e(n);break;default:break}return n}function yt(t,e){return(e||[]).filter(r=>r.type!=="()").map(r=>L(r,t))}function ft(t,e){return!e||e.length===0?[{name:"",type:{type:"void"}}]:e.filter(r=>r.type!=="()").map(r=>L(r,t))}function V(t,e,r){let n=[],i={struct:[],enum:[],tuple:[]};function s(a){["struct","enum","tuple"].includes(a.type)&&i[a.type].findIndex(o=>o.structName===a.structName)===-1&&i[a.type].push(a)}t.forEach(a=>{a.type==="function"&&n.push(lt(a,s,r))});let u=n.reduce((a,o)=>(Array.isArray(a[o.name])?a[o.name].push(o):a[o.name]=[o],a),{}),S=i.struct.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{}),h=i.tuple.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{}),x=i.enum.reduce((a,o)=>(a[o.structName]?a[o.structName].push(o):a[o.structName]=[o],a),{});return{name:d(e),rawName:e,functions:u,structs:S,tuples:h,enums:x}}function gt(t,e){let r=`${t.name}(${(t.inputs||[]).map(({type:n})=>n).join(",")})`;return e&&e.methods&&e.methods[r]}var b=class extends Error{};function W(t){let e;try{e=JSON.parse(t)}catch{throw new b("Not a json")}if(!e)throw new b("Not a json");if(Array.isArray(e))return e;if(Array.isArray(e.abi))return e.abi;if(e.compilerOutput&&Array.isArray(e.compilerOutput.abi))return e.compilerOutput.abi;throw new b("Not a valid ABI")}function J(t){let e;try{e=JSON.parse(t)}catch{return}if(!e||!e.devdoc&&!e.userdoc)return;let r=e.devdoc||{};if(e.userdoc){if(r.notice=e.userdoc.notice,!e.userdoc.methods)return r;r.methods=r.methods||{},Object.entries(e.userdoc.methods).forEach(([n,{notice:i}])=>{r.methods&&(r.methods[n]=m(c({},r.methods[n]),{notice:i}))})}return r}var ht="./types/fuels-contracts/",F=class extends Tt{constructor(r){super(r);this.name="Fuels";this.contractCache={};let{cwd:n,outDir:i,allFiles:s}=r;this.outDirAbs=bt(n,i||ht),this.allContracts=s.map(u=>d(K(u)))}transformFile(r){let n=K(r.path),i=W(r.contents);if(i.length===0)return;let s=J(r.contents),u=V(i,n,s);return this.contractCache[n]={abi:i,contract:u},[this.genContractTypingsFile(u,this.cfg.flags)]}genContractTypingsFile(r,n){return{path:T(this.outDirAbs,`${r.name}.d.ts`),contents:G(r,n)}}afterRun(){return[...Object.keys(this.contractCache).map(i=>{let{contract:s,abi:u}=this.contractCache[i];return{path:T(this.outDirAbs,"factories",`${s.name}${D}.ts`),contents:z(s,u)}}),{path:T(this.outDirAbs,"common.d.ts"),contents:dt(T(p,"../static/common.d.ts"),"utf-8")},{path:T(this.outDirAbs,"index.ts"),contents:this.genReExports()}].filter(Boolean)}genReExports(){let r=[],n=new Set(this.allContracts);for(let i of n){let s=i;r.push(`export type { ${s} } from './${s}'`)}r.push(`
`);for(let i of n){let s=`${i}__factory`;r.push(`export { ${s} } from './factories/${s}'`)}return r.join(`
`)}};export{F as default};
//# sourceMappingURL=index.mjs.map